(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{201:function(e,t,o){"use strict";o.r(t);var r=o(0),i=Object(r.a)({},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("h1",{attrs:{id:"troubleshooting"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting","aria-hidden":"true"}},[e._v("#")]),e._v(" Troubleshooting")]),e._v(" "),o("h2",{attrs:{id:"the-nextflow-process"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#the-nextflow-process","aria-hidden":"true"}},[e._v("#")]),e._v(" The Nextflow Process")]),e._v(" "),o("p",[e._v("You can follow the Nextflow process by following what is printed to "),o("code",[e._v("stdout")]),e._v(". Additionally, the Nextflow Java process creates a "),o("code",[e._v(".nextflow.log")]),e._v(" file in the run directory where warnings and errors are logged.")]),e._v(" "),o("div",{staticClass:"tip custom-block"},[o("p",{staticClass:"custom-block-title"},[e._v("Note")]),e._v(" "),o("ul",[o("li",[e._v("The last executed Nextflow call in the run directory will be in the first few lines of "),o("code",[e._v(".nextflow.log")]),e._v(".")]),e._v(" "),o("li",[e._v("Repeated calls to "),o("code",[e._v("nextflow run")]),e._v(" in the same directory renames older output files from the Nextflow process, for example "),o("code",[e._v(".nextflow.log.3")]),e._v(" is from three runs prior to the current one.")])])]),e._v(" "),o("h2",{attrs:{id:"individual-jobs"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#individual-jobs","aria-hidden":"true"}},[e._v("#")]),e._v(" Individual Jobs")]),e._v(" "),o("p",[e._v("A job running a single process inside the pipeline can fail due to inadequate resources, which will trigger a re-run with increased resources. For other failures, you need to look inside the "),o("code",[e._v("work")]),e._v(" directory. In the "),o("code",[e._v(".html")]),e._v(" reports generated by default (or the "),o("code",[e._v("trace.txt")]),e._v(" file) in the run directory you will find for each process run its status ("),o("code",[e._v("COMPLETED")]),e._v("; "),o("code",[e._v("CACHED")]),e._v(" if resumed and completed in a prior run; and "),o("code",[e._v("FAILED")]),e._v(" if an error occured) and a "),o("code",[e._v("hash")]),e._v(". The hash indicates the subdirectory in which the process was run (for example "),o("code",[e._v("a4/00365e")]),e._v(" points to "),o("code",[e._v("work/a4/00365e9190eca55907746edeb58f77")]),e._v("). In this directory you find the following files which are useful for troubleshooting:")]),e._v(" "),o("ul",[o("li",[o("code",[e._v(".command.run")]),e._v(": This is the actual script which sets environment variables and runs "),o("code",[e._v(".command.sh")]),e._v(", Nextflow submits this to LSF using bsub. You can manually resubmit it by running "),o("code",[e._v("bsub < .command.run")]),e._v(".")]),e._v(" "),o("li",[o("code",[e._v(".command.sh")]),e._v(": This contains the command-line calls that are defined in the corresponding process in "),o("code",[e._v("pipeline.nf")]),e._v(".")]),e._v(" "),o("li",[o("code",[e._v(".command.log")]),e._v(": Contains "),o("code",[e._v("stdout")]),e._v(" from the process itself and "),o("code",[e._v("bsub")]),e._v(".")]),e._v(" "),o("li",[o("code",[e._v(".command.out")]),e._v(": "),o("code",[e._v("stdout")]),e._v(" from the process.")]),e._v(" "),o("li",[o("code",[e._v(".command.err")]),e._v(": "),o("code",[e._v("stderr")]),e._v(" from the process.")])]),e._v(" "),o("p",[e._v("Additionally, any files used by the process are symlinked in the work directory, and any intermediate and final output files are also left here.")]),e._v(" "),o("h2",{attrs:{id:"standard-lsf-errors"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#standard-lsf-errors","aria-hidden":"true"}},[e._v("#")]),e._v(" Standard LSF Errors")]),e._v(" "),o("p",[e._v("When debugging pipeline runs, there are common errors one encounters. An incomplete list of LSF job exit codes is provided below:")]),e._v(" "),o("ul",[o("li",[e._v("error code "),o("code",[e._v("0")]),e._v(" --- this means the jobs was considered successfully run")]),e._v(" "),o("li",[e._v("error code "),o("code",[e._v("1")]),e._v(" --- this is a standard error code, which normally could mean something is wrong with the code itself")]),e._v(" "),o("li",[e._v("error code "),o("code",[e._v("130")]),e._v(" --- this means there is not enough memory for the process to complete")]),e._v(" "),o("li",[e._v("error code "),o("code",[e._v("140")]),e._v(" --- this means there was not enough time requested via LSF, which is translated from Nextflow into "),o("code",[e._v("bsub -W")]),e._v(" as detailed "),o("a",{attrs:{href:"https://www.ibm.com/support/knowledgecenter/en/SSETD4_9.1.3/lsf_command_ref/bsub.__w.1.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),o("OutboundLink")],1)])]),e._v(" "),o("h2",{attrs:{id:"singularity-errors"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#singularity-errors","aria-hidden":"true"}},[e._v("#")]),e._v(" Singularity Errors")]),e._v(" "),o("p",[e._v("The most common error one sees with Singularity is the error "),o("code",[e._v("Failed to pull singularity image")]),e._v(", e.g.")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("ERROR ~ Error executing process > 'VariantCaller'\n\nCaused by:\n  Failed to pull singularity image\n  command: singularity pull  --name cmopipeline-variantcaller-1.0.0.img docker://cmopipeline/variantcaller:1.0.0 > /dev/null\n  status : 255\n  message:\n    [33mWARNING: Authentication token file not found : Only pulls of public images will succeed\n    INFO:    Starting build...\n    Getting image source signatures\n    Skipping fetch of repeat blob sha256:g2wi99s7f5ij1buyrr0ep5tf8xjfk05lwc9vr3adlbgxbw1zvxlmx8053n4lvmsm\n    Skipping fetch of repeat blob sha256:z1k6kz1157i0vy8r9eutu3cmfzp48wyeoxyusha8r681x725o4vwb468952vaao3\n    Skipping fetch of repeat blob sha256:twc7y14h8qub3vi5i8vxvp0qxhtw01mee7nc5j7qjyhol5nx4e22fjl5kawlzf53\n    Skipping fetch of repeat blob sha256:ex0gy93dwd19y35433v8n4kcozowo964jx8zt088ltd9edw8a5gob94qc9coyhc6\n    Skipping fetch of repeat blob sha256:n54clmgy1tep6l409gdnkf980nvm1607oa6jr34po8q2v7u2l82o3z4rq9k6ctvg\n    Copying config sha256:4s26zd3jojt2mch7t41ek56uabitwg91p7b530upbeeoyjmql6uw24wgxr5x6fel\n\n     0 B / 2.55 KiB [--------------------------------------------------------------]\n     2.55 KiB / 2.55 KiB [======================================================] 0s\n    Writing manifest to image destination\n    Storing signatures\n    FATAL:   Unable to pull docker://cmopipeline/variantcaller:1.0.0: conveyor failed to get: no descriptor found for reference \"3sw08cr0yd460ygwyjn2p29y40lakjnw9y2nj5w20za960059fij5okthwc87l66\"\n")])])]),o("p",[e._v("The error occurs when users are downloading pre-built images on Dockerhub via "),o("code",[e._v("singularity pull")]),e._v(' for the first time, i.e. "pulling" singularity images for the first time. This situation can be avoided if you set the variable '),o("code",[e._v("NXF_SINGULARITY_CACHEDIR")]),e._v(" to the subdirectory containing these images, which have already been downloaded on site. (Please read "),o("router-link",{attrs:{to:"/juno-setup.html"}},[e._v("Juno Setup")]),e._v(" and "),o("router-link",{attrs:{to:"/working-with-coontainers.html"}},[e._v("Working with Containers")]),e._v(" for more details on this topic.)")],1),e._v(" "),o("p",[e._v("Another option would be to simply execute the command above, i.e.")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("singularity pull  --name cmopipeline-fastp-1.0.0.img docker://cmopipeline/fastp:1.0.0 > /dev/null\n")])])]),o("div",{staticClass:"warning custom-block"},[o("p",{staticClass:"custom-block-title"},[e._v("Be aware")]),e._v(" "),o("p",[e._v("The command "),o("code",[e._v("singularity pull")]),e._v(" tends to take quite some time to run, and often slows down the login server for everyone. We recommend you don't do this often. Setting the variable "),o("code",[e._v("NXF_SINGULARITY_CACHEDIR")]),e._v(" to a location with already-downloaded images would be far more efficient.")])])])},[],!1,null,null,null);t.default=i.exports}}]);